<html>
<head>
    <title>sample</title>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Quicksand" />
    
    <link rel="stylesheet" type="text/css" href="css/icons.css" />
    <link rel="stylesheet" type="text/css" href="libs/tipsy/css/tipsy.css" />

    <link rel="stylesheet" type="text/css" href="css/simple-grid.css" />

    <!-- lib -->
    <script type="text/javascript" src="libs/jquery-1.8.3.min.js" ></script>
    <script type="text/javascript" src="libs/underscore-min.js" ></script>
    <script type="text/javascript" src="libs/backbone-min.js" ></script>
    <script type="text/javascript" src="libs/tipsy/jquery.tipsy.js" ></script>

    <!-- simple grid -->
    <script type="text/javascript" src="libs/simple-grid-min.js" ></script>
</head>


<body>
<script>
    $(document).ready(function(){

        var buildCover = function(v, o){
            return '<center><img width="61" height="91" src="'+ o.posters.thumbnail +'"></center>'
        };

        var buildDescription = function (v, o){

            o.critics_consensus = o.critics_consensus || "";

            var html = [];
            html.push("<div style='font-size:13px;'>");
            html.push("<b><span style='text-decoration:underline;'>" + "[" + o.year + "] - " + o.title + "</span></b><br/>");
            html.push("<span>"+ o.critics_consensus + "</span>");
            html.push("</div>");
            return html.join('');
        };

        var grid = new App.view.Grid({
            el:$('#grid'),
            cm:[{ id:'posters', name:'cover', width:100, render:buildCover},
                { id:'title', name:'description', width:300, render:buildDescription},
                { id:'mpaa_rating', name:'Mpaa Rating', css:{textAlign:'center'}, width:150 }]
        });

        var query  = function(page){
            function cb(result) {
                var data = result.movies;
                grid.setValues(data);
            };


            var movie = "starwar";
            var key = "jzb4xe5unjzj6rk7gmug2z6j";
            var page_limit = 5;

            var q = "http://api.rottentomatoes.com/api/public/v1.0/movies.json"
                + "?apikey=" + key
                + "&q=" + movie
                + "&page_limit=" + page_limit
                + "&page=" + page; 

            $.ajax({
                dataType: 'jsonp',
                url: q,
                success: cb
            });
        };

        //pagging toolbar.
        this.pag = new App.view.PagingToolbar({
            el:$('#paging'),
            lastPage: 4 //TODO change this magic number
        });

        this.pag.on('pageChange', function(p){
            query(p);
        },this);

        //first call
        query(1);
    });
</script>

<h1>Demo</h1>
<br/>
<div id="grid"></div>
<div id="paging"></div>
<br/>
</body>
</html>
